import os
import base64
import subprocess

folder_path = f'modules/translation'

file_data = [
    ('translation_module.py', 'aW1wb3J0IG9zCmltcG9ydCBpbwppbXBvcnQgYmFzZTY0CmZyb20gdHlwaW5nIGltcG9ydCBVbmlvbiwgT3B0aW9uYWwKZnJvbSBmYXN0YXBpIGltcG9ydCBIVFRQRXhjZXB0aW9uCmZyb20gZG90ZW52IGltcG9ydCBsb2FkX2RvdGVudgpmcm9tIGxvZ3VydSBpbXBvcnQgbG9nZ2VyCgpmcm9tIC5kYXRhX21vZGVscyBpbXBvcnQgVHJhbnNsYXRpb25SZXF1ZXN0LCBNaW5lckNvbmZpZywgTW9kdWxlQ29uZmlnLCBCYXNlTWluZXIsIFRyYW5zbGF0aW9uQ29uZmlnCmZyb20gLnRyYW5zbGF0aW9uIGltcG9ydCBUcmFuc2xhdGlvbgoKbG9hZF9kb3RlbnYoKQoKCm1vZHVsZV9zZXR0aW5ncyA9IE1vZHVsZUNvbmZpZygKICAgIG1vZHVsZV9wYXRoPSJtb2R1bGUvdHJhbnNsYXRpb24iLAogICAgbW9kdWxlX25hbWU9InRyYW5zbGF0aW9uIiwKICAgIG1vZHVsZV9lbmRwb2ludD0iL21vZHVsZXMvdHJhbnNsYXRpb24iLAogICAgbW9kdWxlX3VybD0iaHR0cHM6Ly90cmFuc2xhdGlvbi5jb20vIgopCgptaW5lcl9zZXR0aW5ncyA9IE1pbmVyQ29uZmlnKAogICAgbW9kdWxlX25hbWU9InRyYW5zbGF0aW9uIiwKICAgIG1vZHVsZV9wYXRoPSJtb2R1bGVzL3RyYW5zbGF0aW9uIiwKICAgIG1vZHVsZV9lbmRwb2ludD0iL21vZHVsZXMvdHJhbnNsYXRpb24iLAogICAgbW9kdWxlX3VybD0iaHR0cHM6Ly90cmFuc2xhdGlvbi5jb20vIiwKICAgIG1pbmVyX2tleV9kaWN0PXsKICAgICAgICAidGVzdF9taW5lcl8xIjogewogICAgICAgICAgICAia2V5IjogIjVHTjJkTGhXYTVzQ0I0QTU1OEJra2g5NkJOZHd3aWtQeENCSlc2SFFYbVFmN3lwUiIsCiAgICAgICAgICAgICJuYW1lIjogInRlc3RfbWluZXJfMSIsCiAgICAgICAgICAgICJob3N0IjogIjAuMC4wLjAiLAogICAgICAgICAgICAicG9ydCI6IDQyNjksCiAgICAgICAgICAgICJrZXlwYXRoIjogIiRIT01FLy5jb21tdW5lL2tleS90ZXN0X21pbmVyXzEuanNvbiIKICAgICAgICB9CiAgICB9LAopCnRyYW5zbGF0b3IgPSBUcmFuc2xhdGlvbihUcmFuc2xhdGlvbkNvbmZpZygpKQoKCmNsYXNzIFRyYW5zbGF0aW9uTWluZXIoQmFzZU1pbmVyKToKICAgIAogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsIAogICAgICAgIHJvdXRlOiBPcHRpb25hbFtzdHJdID0gInRyYW5zbGF0aW9uIiwKICAgICAgICBpbnBhdGg6IE9wdGlvbmFsW3N0cl0gPSAibW9kdWxlcy90cmFuc2xhdGlvbi9pbiIsCiAgICAgICAgb3V0cGF0aDogT3B0aW9uYWxbc3RyXSA9ICJtb2R1bGVzL3RyYW5zbGF0aW9uL291dCIsCiAgICApOgogICAgICAgICIiIgogICAgICAgIEluaXRpYWxpemVzIHRoZSBUcmFuc2xhdGlvbk1pbmVyIGNsYXNzIHdpdGggb3B0aW9uYWwgcm91dGUsIGlucGF0aCwgYW5kIG91dHBhdGggcGFyYW1ldGVycy4KICAgICAgICAKICAgICAgICBQYXJhbWV0ZXJzOgogICAgICAgICAgICByb3V0ZSAoT3B0aW9uYWxbc3RyXSk6IFRoZSByb3V0ZSBmb3IgdGhlIHRyYW5zbGF0aW9uLgogICAgICAgICAgICBpbnBhdGggKE9wdGlvbmFsW3N0cl0pOiBUaGUgaW5wdXQgcGF0aCBmb3IgdHJhbnNsYXRpb24uCiAgICAgICAgICAgIG91dHBhdGggKE9wdGlvbmFsW3N0cl0pOiBUaGUgb3V0cHV0IHBhdGggZm9yIHRyYW5zbGF0aW9uLgogICAgICAgICIiIgogICAgICAgIHN1cGVyKCkuX19pbml0X18obWluZXJfc2V0dGluZ3MsIG1vZHVsZV9zZXR0aW5ncykKICAgICAgICBzZWxmLmFkZF9yb3V0ZShyb3V0ZSkKICAgICAgICAKICAgICAgICBvcy5tYWtlZGlycyhpbnBhdGgsIGV4aXN0X29rPVRydWUpCiAgICAgICAgb3MubWFrZWRpcnMob3V0cGF0aCwgZXhpc3Rfb2s9VHJ1ZSkKICAgIAogICAgZGVmIHByb2Nlc3Moc2VsZiwgbWluZXJfcmVxdWVzdDogVHJhbnNsYXRpb25SZXF1ZXN0KSAtPiBVbmlvbltzdHIsIGJ5dGVzXToKICAgICAgICAiIiIKICAgICAgICBQcm9jZXNzZXMgdGhlIGdpdmVuIGBUcmFuc2xhdGlvblJlcXVlc3RgIG9iamVjdCBhbmQgcmV0dXJucyB0aGUgdHJhbnNsYXRpb24gcmVzdWx0LgoKICAgICAgICBQYXJhbWV0ZXJzOgogICAgICAgICAgICBtaW5lcl9yZXF1ZXN0IChUcmFuc2xhdGlvblJlcXVlc3QpOiBUaGUgcmVxdWVzdCBvYmplY3QgY29udGFpbmluZyB0aGUgaW5wdXQgZGF0YSwgdGFzayBzdHJpbmcsIHNvdXJjZSBsYW5ndWFnZSwgYW5kIHRhcmdldCBsYW5ndWFnZS4KCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgVW5pb25bc3RyLCBieXRlc106IFRoZSB0cmFuc2xhdGlvbiByZXN1bHQuCgogICAgICAgIFJhaXNlczoKICAgICAgICAgICAgSFRUUEV4Y2VwdGlvbjogSWYgYW4gZXJyb3Igb2NjdXJzIGR1cmluZyB0aGUgdHJhbnNsYXRpb24gcHJvY2Vzcy4KCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gdHJhbnNsYXRvci5wcm9jZXNzKG1pbmVyX3JlcXVlc3QpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBwcm9jZXNzaW5nIHRyYW5zbGF0aW9uOiB7ZX0iKQogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRXJyb3IgcHJvY2Vzc2luZyB0cmFuc2xhdGlvbjoge2V9IikgZnJvbSBlCiAgICAKICAgICAgICAKbWluZXIgPSBUcmFuc2xhdGlvbk1pbmVyKCkKCm1pbmVyLmFkZF9yb3V0ZSgidHJhbnNsYXRpb24iKQoKbWluZXIucnVuX3NlcnZlcigiMC4wLjAuMCIsIDQyNjkpCg=='),
    ('translation.py', 'aW1wb3J0IGlvCmltcG9ydCBzY2lweQppbXBvcnQgdG9yY2gKaW1wb3J0IGJhc2U2NAppbXBvcnQgdG9yY2hhdWRpbwoKZnJvbSBsb2d1cnUgaW1wb3J0IGxvZ2dlcgpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IGxydV9jYWNoZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgVHVwbGUsIFVuaW9uCmZyb20gdHJhbnNmb3JtZXJzIGltcG9ydCBBdXRvUHJvY2Vzc29yLCBTZWFtbGVzc000VHYyTW9kZWwKZnJvbSBweWR1YiBpbXBvcnQgQXVkaW9TZWdtZW50Cgpmcm9tIC5kYXRhX21vZGVscyBpbXBvcnQgVEFSR0VUX0xBTkdVQUdFUywgVEFTS19TVFJJTkdTLCBNaW5lclJlcXVlc3QsIFRyYW5zbGF0aW9uQ29uZmlnCgoKY2xhc3MgVHJhbnNsYXRpb246CiAgICBkZWYgX19pbml0X18oc2VsZiwgdHJhbnNsYXRpb25fY29uZmlnOiBUcmFuc2xhdGlvbkNvbmZpZyk6CiAgICAgICAgIiIiCiAgICAgICAgSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFRyYW5zbGF0aW9uIGNsYXNzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICB0cmFuc2xhdGlvbl9jb25maWcgKFRyYW5zbGF0aW9uQ29uZmlnKTogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGZvciB0cmFuc2xhdGlvbi4KCiAgICAgICAgSW5pdGlhbGl6ZXMgdGhlIGZvbGxvd2luZyBpbnN0YW5jZSB2YXJpYWJsZXM6CiAgICAgICAgICAgIC0gdHJhbnNsYXRpb25fY29uZmlnIChUcmFuc2xhdGlvbkNvbmZpZyk6IFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBmb3IgdHJhbnNsYXRpb24uCiAgICAgICAgICAgIC0gcHJvY2Vzc29yIChBdXRvUHJvY2Vzc29yKTogVGhlIHByb2Nlc3NvciBvYmplY3QgZm9yIHByZXByb2Nlc3NpbmcgaW5wdXQgZGF0YS4KICAgICAgICAgICAgLSBtb2RlbCAoU2VhbWxlc3NNNFR2Mk1vZGVsKTogVGhlIG1vZGVsIG9iamVjdCBmb3IgdHJhbnNsYXRpb24uCiAgICAgICAgICAgIC0gZGV2aWNlICh0b3JjaC5kZXZpY2UpOiBUaGUgZGV2aWNlIHRvIHJ1biB0aGUgbW9kZWwgb24gKENVREEgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgQ1BVKS4KICAgICAgICAgICAgLSB0YXJnZXRfbGFuZ3VhZ2VzIChEaWN0W3N0ciwgc3RyXSk6IEEgZGljdGlvbmFyeSBtYXBwaW5nIHRhcmdldCBsYW5ndWFnZXMgdG8gdGhlaXIgY29kZXMuCiAgICAgICAgICAgIC0gdGFza19zdHJpbmdzIChEaWN0W3N0ciwgc3RyXSk6IEEgZGljdGlvbmFyeSBtYXBwaW5nIHRhc2sgc3RyaW5ncyB0byB0aGVpciBjb2Rlcy4KICAgICAgICAgICAgLSBkYXRhX2lucHV0IChOb25lKTogVGhlIGlucHV0IGRhdGEgZm9yIHRyYW5zbGF0aW9uLgogICAgICAgICAgICAtIHRhc2tfc3RyaW5nIChOb25lKTogVGhlIHRhc2sgc3RyaW5nIGZvciB0cmFuc2xhdGlvbi4KICAgICAgICAgICAgLSBzb3VyY2VfbGFuZ3VhZ2UgKE5vbmUpOiBUaGUgc291cmNlIGxhbmd1YWdlIGZvciB0cmFuc2xhdGlvbi4KICAgICAgICAgICAgLSB0YXJnZXRfbGFuZ3VhZ2UgKE5vbmUpOiBUaGUgdGFyZ2V0IGxhbmd1YWdlIGZvciB0cmFuc2xhdGlvbi4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnRyYW5zbGF0aW9uX2NvbmZpZyA9IHRyYW5zbGF0aW9uX2NvbmZpZwogICAgICAgIHNlbGYucHJvY2Vzc29yID0gQXV0b1Byb2Nlc3Nvci5mcm9tX3ByZXRyYWluZWQodHJhbnNsYXRpb25fY29uZmlnLm1vZGVsX25hbWVfb3JfY2FyZCkKICAgICAgICBzZWxmLm1vZGVsID0gU2VhbWxlc3NNNFR2Mk1vZGVsLmZyb21fcHJldHJhaW5lZCh0cmFuc2xhdGlvbl9jb25maWcubW9kZWxfbmFtZV9vcl9jYXJkKQogICAgICAgIHNlbGYuZGV2aWNlID0gdG9yY2guZGV2aWNlKCJjdWRhIiBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpIGVsc2UgImNwdSIpCiAgICAgICAgc2VsZi5tb2RlbC50byhzZWxmLmRldmljZSkKICAgICAgICBzZWxmLnRhcmdldF9sYW5ndWFnZXM6IERpY3Rbc3RyLCBzdHJdID0gVEFSR0VUX0xBTkdVQUdFUwogICAgICAgIHNlbGYudGFza19zdHJpbmdzOiBEaWN0W3N0ciwgc3RyXSA9IFRBU0tfU1RSSU5HUwogICAgICAgIHNlbGYuZGF0YV9pbnB1dCA9IE5vbmUKICAgICAgICBzZWxmLnRhc2tfc3RyaW5nID0gTm9uZQogICAgICAgIHNlbGYuc291cmNlX2xhbmd1YWdlID0gTm9uZQogICAgICAgIHNlbGYudGFyZ2V0X2xhbmd1YWdlID0gTm9uZQoKICAgIEBscnVfY2FjaGUobWF4c2l6ZT0xMjgpCiAgICBkZWYgX2dldF9sYW5ndWFnZShzZWxmLCBsYW5ndWFnZTogc3RyKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgRnVuY3Rpb24gdG8gcmV0cmlldmUgdGhlIGxhbmd1YWdlIGZyb20gdGhlIHRhcmdldF9sYW5ndWFnZXMgZGljdGlvbmFyeS4KICAgICAgICAKICAgICAgICBQYXJhbWV0ZXJzOgogICAgICAgICAgICBzZWxmOiBUaGUgVHJhbnNsYXRpb24gb2JqZWN0LgogICAgICAgICAgICBsYW5ndWFnZTogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBsYW5ndWFnZSB0byByZXRyaWV2ZS4KICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGxhbmd1YWdlIGZyb20gdGhlIHRhcmdldF9sYW5ndWFnZXMgZGljdGlvbmFyeS4KICAgICAgICAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnRhcmdldF9sYW5ndWFnZXNbbGFuZ3VhZ2VdCiAgICAgICAgZXhjZXB0IEtleUVycm9yIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkludmFsaWQgbGFuZ3VhZ2U6IHtsYW5ndWFnZX0ge2V9IikKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIkludmFsaWQgbGFuZ3VhZ2U6IHtsYW5ndWFnZX0iKSBmcm9tIGUKCiAgICBkZWYgcHJvY2VzcyhzZWxmLCBtaW5lcl9yZXF1ZXN0OiBNaW5lclJlcXVlc3QpIC0+IFR1cGxlW1VuaW9uW3N0ciwgTm9uZV0sIFVuaW9uW3RvcmNoLlRlbnNvciwgTm9uZV1dOgogICAgICAgICIiIgogICAgICAgIEEgZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgYSBNaW5lclJlcXVlc3Qgb2JqZWN0IHRvIHBlcmZvcm0gdHJhbnNsYXRpb24gdGFza3MuIAogICAgICAgIFJldHJpZXZlcyBpbnB1dCBkYXRhLCB0YXNrIHN0cmluZywgc291cmNlIGFuZCB0YXJnZXQgbGFuZ3VhZ2VzLCBwcmVwcm9jZXNzZXMgdGhlIGlucHV0IGRhdGEsIAogICAgICAgIHByZWRpY3RzIHRoZSBvdXRwdXQgYmFzZWQgb24gdGhlIGlucHV0IGFuZCBsYW5ndWFnZXMsIGFuZCBwcm9jZXNzZXMgdGhlIGZpbmFsIG91dHB1dC4gCiAgICAgICAgUmFpc2VzIFZhbHVlRXJyb3JzIGZvciBpbnZhbGlkIHRhc2sgc3RyaW5ncyBhbmQgbWlzc2luZyBpbnB1dCBkYXRhLgoKICAgICAgICBQYXJhbWV0ZXJzOgogICAgICAgICAgICBzZWxmOiBUaGUgVHJhbnNsYXRpb24gb2JqZWN0LgogICAgICAgICAgICBtaW5lcl9yZXF1ZXN0IChNaW5lclJlcXVlc3QpOiBUaGUgcmVxdWVzdCBvYmplY3QgY29udGFpbmluZyBpbnB1dCBkYXRhLCB0YXNrIHN0cmluZywgCiAgICAgICAgICAgICAgICBzb3VyY2UgbGFuZ3VhZ2UsIGFuZCB0YXJnZXQgbGFuZ3VhZ2UuCgogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIFR1cGxlW1VuaW9uW3N0ciwgTm9uZV0sIFVuaW9uW3RvcmNoLlRlbnNvciwgTm9uZV1dOiAKICAgICAgICAgICAgICAgIEEgdHVwbGUgY29udGFpbmluZyBlaXRoZXIgYSBzdHJpbmcgb3IgTm9uZSwgYW5kIGVpdGhlciBhIHRvcmNoLlRlbnNvciBvciBOb25lLCAKICAgICAgICAgICAgICAgIHJlcHJlc2VudGluZyB0aGUgcHJvY2Vzc2VkIG91dHB1dC4KICAgICAgICAiIiIKICAgICAgICBpZiAiaW5wdXQiIGluIG1pbmVyX3JlcXVlc3QuZGF0YToKICAgICAgICAgICAgc2VsZi5kYXRhX2lucHV0ID0gbWluZXJfcmVxdWVzdC5kYXRhWyJpbnB1dCJdCiAgICAgICAgaWYgInRhc2tfc3RyaW5nIiBpbiBtaW5lcl9yZXF1ZXN0LmRhdGE6CiAgICAgICAgICAgIHNlbGYudGFza19zdHJpbmcgPSBtaW5lcl9yZXF1ZXN0LmRhdGFbInRhc2tfc3RyaW5nIl0KICAgICAgICBpZiAic291cmNlX2xhbmd1YWdlIiBpbiBtaW5lcl9yZXF1ZXN0LmRhdGE6CiAgICAgICAgICAgIHNlbGYuc291cmNlX2xhbmd1YWdlID0gbWluZXJfcmVxdWVzdC5kYXRhWyJzb3VyY2VfbGFuZ3VhZ2UiXS50aXRsZSgpCiAgICAgICAgaWYgInRhcmdldF9sYW5ndWFnZSIgaW4gbWluZXJfcmVxdWVzdC5kYXRhOgogICAgICAgICAgICBzZWxmLnRhcmdldF9sYW5ndWFnZSA9IG1pbmVyX3JlcXVlc3QuZGF0YVsidGFyZ2V0X2xhbmd1YWdlIl0udGl0bGUoKQoKICAgICAgICBpZiBub3Qgc2VsZi50YXNrX3N0cmluZzoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIkludmFsaWQgdGFzayBzdHJpbmc6IHttaW5lcl9yZXF1ZXN0LmRhdGF9IikKCiAgICAgICAgaWYgc2VsZi5kYXRhX2lucHV0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIk5vIGlucHV0IHByb3ZpZGVkIikKICAgICAgICBpZiBzZWxmLnRhc2tfc3RyaW5nLnN0YXJ0c3dpdGgoInNwZWVjaCIpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi5kYXRhX2lucHV0ID0gc2VsZi5fcHJlcHJvY2VzcyhzZWxmLmRhdGFfaW5wdXQpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHByZXByb2Nlc3NpbmcgaW5wdXQ6IHtlfSIpCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiRXJyb3IgcHJlcHJvY2Vzc2luZyBpbnB1dDoge2V9IikgZnJvbSBlCiAgICAgICAgCiAgICAgICAgb3V0cHV0ID0gTm9uZQogICAgICAgIHdpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgICAgICAgICBvdXRwdXQgPSBzZWxmLl9wcmVkaWN0KAogICAgICAgICAgICAgICAgaW5wdXQ9c2VsZi5kYXRhX2lucHV0LAogICAgICAgICAgICAgICAgdGFza19zdHI9c2VsZi50YXNrX3N0cmluZ3Nbc2VsZi50YXNrX3N0cmluZ10sCiAgICAgICAgICAgICAgICBzcmNfbGFuZz1zZWxmLnRhcmdldF9sYW5ndWFnZXNbc2VsZi5zb3VyY2VfbGFuZ3VhZ2VdLAogICAgICAgICAgICAgICAgdGd0X2xhbmc9c2VsZi50YXJnZXRfbGFuZ3VhZ2VzW3NlbGYudGFyZ2V0X2xhbmd1YWdlXQogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgIGlmIHNlbGYudGFza19zdHJpbmcuZW5kc3dpdGgoInNwZWVjaCIpOgogICAgICAgICAgICBvdXRwdXQgPSBzZWxmLl9wcm9jZXNzX2F1ZGlvX291dHB1dChvdXRwdXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LmVuY29kZSgidXRmLTgiKQoKICAgICAgICByZXR1cm4gc2VsZi5fcHJvY2Vzc19vdXRwdXQob3V0cHV0KQogICAgCiAgICBkZWYgX3ByZXByb2Nlc3Moc2VsZiwgaW5wdXRfZGF0YSk6CiAgICAgICAgIiIiCiAgICAgICAgUHJlcHJvY2Vzc2VzIHRoZSBpbnB1dCBkYXRhIGJ5IHdyaXRpbmcgaXQgdG8gYSBmaWxlIGFuZCByZXR1cm5pbmcgdGhlIGZpbGUgcGF0aC4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgaW5wdXRfZGF0YSAoc3RyKTogVGhlIGJhc2U2NCBlbmNvZGVkIGF1ZGlvIGRhdGEgdG8gYmUgcHJlcHJvY2Vzc2VkLgoKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBzdHI6IFRoZSBmaWxlIHBhdGggb2YgdGhlIHByZXByb2Nlc3NlZCBhdWRpbyBmaWxlLgoKICAgICAgICBSYWlzZXM6CiAgICAgICAgICAgIE5vbmUKICAgICAgICAiIiIKICAgICAgICB3aXRoIG9wZW4oIm1vZHVsZXMvdHJhbnNsYXRpb24vaW4vYXVkaW9fcmVxdWVzdC53YXYiLCAid2IiKSBhcyBmOgogICAgICAgICAgICBmLndyaXRlKGJhc2U2NC5iNjRkZWNvZGUoaW5wdXRfZGF0YSkpCiAgICAgICAgcmV0dXJuICJtb2R1bGVzL3RyYW5zbGF0aW9uL2luL2F1ZGlvX3JlcXVlc3Qud2F2IgogICAgCiAgICBkZWYgX3Byb2Nlc3NfdGV4dF9pbnB1dHMoc2VsZiwgaW5wdXRfZGF0YTogc3RyLCBzcmNfbGFuZzogc3RyKSAtPiBEaWN0W3N0ciwgdG9yY2guVGVuc29yXToKICAgICAgICAiIiIKICAgICAgICBQcm9jZXNzZXMgdGV4dCBpbnB1dHMgYnkgdXRpbGl6aW5nIHRoZSBwcm9jZXNzb3IgdG8gY29udmVydCBpbnB1dCBkYXRhIGludG8gdG9yY2ggdGVuc29ycy4KCiAgICAgICAgUGFyYW1ldGVyczoKICAgICAgICAgICAgc2VsZjogVGhlIFRyYW5zbGF0aW9uIG9iamVjdC4KICAgICAgICAgICAgaW5wdXRfZGF0YSAoc3RyKTogVGhlIGlucHV0IHRleHQgZGF0YSB0byBiZSBwcm9jZXNzZWQuCiAgICAgICAgICAgIHNyY19sYW5nIChzdHIpOiBUaGUgc291cmNlIGxhbmd1YWdlIG9mIHRoZSBpbnB1dCB0ZXh0LgoKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBEaWN0W3N0ciwgdG9yY2guVGVuc29yXTogQSBkaWN0aW9uYXJ5IGNvbnRhaW5pbmcgdG9yY2ggdGVuc29ycyBhcyB2YWx1ZXMgZm9yIGRpZmZlcmVudCBrZXlzLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLnByb2Nlc3Nvcih0ZXh0PWlucHV0X2RhdGEsIHNyY19sYW5nPXNyY19sYW5nLCByZXR1cm5fdGVuc29ycz0icHQiKQoKICAgIGRlZiBfcHJvY2Vzc19hdWRpb19pbnB1dChzZWxmLCBpbnB1dF9kYXRhOiBzdHIsIHNyY19sYW5nOiBzdHIpIC0+IERpY3Rbc3RyLCB0b3JjaC5UZW5zb3JdOgogICAgICAgICIiIgogICAgICAgIFByb2Nlc3NlcyB0aGUgYXVkaW8gaW5wdXQgZGF0YSBhbmQgcmV0dXJucyBhIGRpY3Rpb25hcnkgb2YgdGVuc29ycy4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgaW5wdXRfZGF0YSAoc3RyKTogVGhlIHBhdGggdG8gdGhlIGF1ZGlvIGZpbGUuCiAgICAgICAgICAgIHNyY19sYW5nIChzdHIpOiBUaGUgc291cmNlIGxhbmd1YWdlIG9mIHRoZSBhdWRpby4KCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdFtzdHIsIHRvcmNoLlRlbnNvcl06IEEgZGljdGlvbmFyeSBjb250YWluaW5nIHRoZSBwcm9jZXNzZWQgdGVuc29ycy4KICAgICAgICAiIiIKICAgICAgICB3YXZlZm9ybSwgc2FtcGxlX3JhdGUgPSB0b3JjaGF1ZGlvLmxvYWQoaW5wdXRfZGF0YSkKICAgICAgICBpZiBzYW1wbGVfcmF0ZSAhPSAxNjAwMDoKICAgICAgICAgICAgd2F2ZWZvcm0gPSB0b3JjaGF1ZGlvLmZ1bmN0aW9uYWwucmVzYW1wbGUod2F2ZWZvcm0sIHNhbXBsZV9yYXRlLCAxNjAwMCkKICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzb3IoYXVkaW9zPXdhdmVmb3JtLnNxdWVlemUoKSwgc3JjX2xhbmc9c3JjX2xhbmcsIHNhbXBsaW5nX3JhdGU9MTYwMDAsIHJldHVybl90ZW5zb3JzPSJwdCIpCgogICAgZGVmIF9nZW5lcmF0ZV9hdWRpbyhzZWxmLCBpbnB1dF9kYXRhOiBEaWN0W3N0ciwgdG9yY2guVGVuc29yXSwgdGd0X2xhbmc6IHN0cikgLT4gdG9yY2guVGVuc29yOgogICAgICAgICIiIgogICAgICAgIEdlbmVyYXRlIGFuIGF1ZGlvIHRlbnNvciBiYXNlZCBvbiB0aGUgaW5wdXQgZGF0YSBhbmQgdGFyZ2V0IGxhbmd1YWdlLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBpbnB1dF9kYXRhIChEaWN0W3N0ciwgdG9yY2guVGVuc29yXSk6IEEgZGljdGlvbmFyeSBjb250YWluaW5nIGlucHV0IGRhdGEgdGVuc29ycy4KICAgICAgICAgICAgdGd0X2xhbmcgKHN0cik6IFRoZSB0YXJnZXQgbGFuZ3VhZ2UgZm9yIHRoZSBnZW5lcmF0ZWQgYXVkaW8uCgogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIHRvcmNoLlRlbnNvcjogVGhlIGdlbmVyYXRlZCBhdWRpbyB0ZW5zb3IuCgogICAgICAgICIiIgogICAgICAgIGlucHV0X2RhdGEgPSB7azogdi50byhzZWxmLmRldmljZSkgZm9yIGssIHYgaW4gaW5wdXRfZGF0YS5pdGVtcygpfQogICAgICAgIHJldHVybiBzZWxmLm1vZGVsLmdlbmVyYXRlKCoqaW5wdXRfZGF0YSwgdGd0X2xhbmc9dGd0X2xhbmcpWzBdCgogICAgZGVmIF9nZW5lcmF0ZV90ZXh0KHNlbGYsIGlucHV0X2RhdGE6IERpY3Rbc3RyLCB0b3JjaC5UZW5zb3JdLCB0Z3RfbGFuZzogc3RyKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgR2VuZXJhdGVzIHRleHQgYmFzZWQgb24gdGhlIGlucHV0IGRhdGEgYW5kIHRhcmdldCBsYW5ndWFnZS4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgaW5wdXRfZGF0YSAoRGljdFtzdHIsIHRvcmNoLlRlbnNvcl0pOiBBIGRpY3Rpb25hcnkgY29udGFpbmluZyBpbnB1dCBkYXRhIHRlbnNvcnMuCiAgICAgICAgICAgIHRndF9sYW5nIChzdHIpOiBUaGUgdGFyZ2V0IGxhbmd1YWdlIGZvciB0aGUgZ2VuZXJhdGVkIHRleHQuCgogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIHN0cjogVGhlIGdlbmVyYXRlZCB0ZXh0LgogICAgICAgICIiIgogICAgICAgIGlucHV0X2RhdGEgPSB7azogdi50byhzZWxmLmRldmljZSkgZm9yIGssIHYgaW4gaW5wdXRfZGF0YS5pdGVtcygpfQogICAgICAgIG91dHB1dF90b2tlbnMgPSBzZWxmLm1vZGVsLmdlbmVyYXRlKCoqaW5wdXRfZGF0YSwgdGd0X2xhbmc9dGd0X2xhbmcsIGdlbmVyYXRlX3NwZWVjaD1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzb3IuZGVjb2RlKG91dHB1dF90b2tlbnNbMF0udG9saXN0KClbMF0sIHNraXBfc3BlY2lhbF90b2tlbnM9VHJ1ZSkKCiAgICBkZWYgX3ByZWRpY3Qoc2VsZiwgKiprd2FyZ3MpIC0+IFR1cGxlW1VuaW9uW3N0ciwgTm9uZV0sIFVuaW9uW3RvcmNoLlRlbnNvciwgTm9uZV1dOgogICAgICAgICIiIgogICAgICAgIEEgZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgaW5wdXQgZGF0YSBmb3IgcHJlZGljdGlvbi4gCiAgICAgICAgUmV0cmlldmVzIGlucHV0IGRhdGEsIHRhc2sgc3RyaW5nLCBzb3VyY2UgYW5kIHRhcmdldCBsYW5ndWFnZXMsIHByZXByb2Nlc3NlcyB0aGUgaW5wdXQgZGF0YSBiYXNlZCBvbiB0aGUgdGFzayBzdHJpbmcsIAogICAgICAgIGdlbmVyYXRlcyBvdXRwdXQgYmFzZWQgb24gdGhlIGlucHV0IGFuZCBsYW5ndWFnZXMsIGFuZCByZXR1cm5zIHRoZSBvdXRwdXQuIAogICAgICAgIExvZ3MgaW50ZXJtZWRpYXRlIGluZm9ybWF0aW9uIGZvciBkZWJ1Z2dpbmcuIAogICAgICAgIFJhaXNlcyBlcnJvcnMgZm9yIHByb2Nlc3NpbmcgYW5kIHByZWRpY3Rpb24gZmFpbHVyZXMuCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgICoqa3dhcmdzOiBBIGRpY3Rpb25hcnkgY29udGFpbmluZyBpbnB1dCBkYXRhLCB0YXNrIHN0cmluZywgc291cmNlIGxhbmd1YWdlLCBhbmQgdGFyZ2V0IGxhbmd1YWdlLgoKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBUdXBsZVtVbmlvbltzdHIsIE5vbmVdLCBVbmlvblt0b3JjaC5UZW5zb3IsIE5vbmVdXTogCiAgICAgICAgICAgICAgICBBIHR1cGxlIGNvbnRhaW5pbmcgZWl0aGVyIGEgc3RyaW5nIG9yIE5vbmUsIGFuZCBlaXRoZXIgYSB0b3JjaC5UZW5zb3Igb3IgTm9uZSwgCiAgICAgICAgICAgICAgICByZXByZXNlbnRpbmcgdGhlIHByZWRpY3RlZCBvdXRwdXQuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbnB1dF9kYXRhID0ga3dhcmdzWydpbnB1dCddCiAgICAgICAgICAgIHRhc2tfc3RyID0ga3dhcmdzWyd0YXNrX3N0ciddCiAgICAgICAgICAgIHNyY19sYW5nID0ga3dhcmdzWydzcmNfbGFuZyddCiAgICAgICAgICAgIHRndF9sYW5nID0ga3dhcmdzWyd0Z3RfbGFuZyddCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiB0YXNrX3N0ci5zdGFydHN3aXRoKCdzMicpOgogICAgICAgICAgICAgICAgaW5wdXRfZGF0YSA9IHNlbGYuX3Byb2Nlc3NfYXVkaW9faW5wdXQoaW5wdXRfZGF0YSwgc3JjX2xhbmcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpbnB1dF9kYXRhID0gc2VsZi5fcHJvY2Vzc190ZXh0X2lucHV0cyhpbnB1dF9kYXRhLCBzcmNfbGFuZykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBsb2dnZXIuZGVidWcoc3RyKGlucHV0X2RhdGEpWzozMF0pCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh0eXBlKGlucHV0X2RhdGEpKQogICAgICAgICAgICBsb2dnZXIuZGVidWcoa3dhcmdzKQogICAgICAgICAgICBvdXRwdXQgPSBOb25lCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIHNlbGYudGFza19zdHJpbmcuZW5kc3dpdGgoInNwZWVjaCIpOgogICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHNlbGYuX2dlbmVyYXRlX2F1ZGlvKGlucHV0X2RhdGEsIHRndF9sYW5nKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBzZWxmLl9nZW5lcmF0ZV90ZXh0KGlucHV0X2RhdGEsIHRndF9sYW5nKQogICAgICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHByb2Nlc3NpbmcgdHJhbnNsYXRpb246IHtlfSIpCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiRXJyb3IgcHJvY2Vzc2luZyB0cmFuc2xhdGlvbjoge2V9IikgZnJvbSBlCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhvdXRwdXQpCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh0eXBlKG91dHB1dCkpCiAgICAgICAgICAgIHJldHVybiBvdXRwdXQKICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHByb2Nlc3NpbmcgdHJhbnNsYXRpb246IHtlfSIpCiAgICAgICAgICAgIHJhaXNlCiAgICAgICAgCiAgICBkZWYgX3Byb2Nlc3NfYXVkaW9fb3V0cHV0KHNlbGYsIG91dHB1dDogdG9yY2guVGVuc29yKSAtPiB0b3JjaC5UZW5zb3I6CiAgICAgICAgIiIiCiAgICAgICAgUHJvY2VzcyB0aGUgYXVkaW8gb3V0cHV0IHRlbnNvciBhbmQgcmV0dXJuIGl0IGFzIGEgYnl0ZXMgb2JqZWN0LgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBvdXRwdXQgKHRvcmNoLlRlbnNvcik6IFRoZSBhdWRpbyBvdXRwdXQgdGVuc29yIHRvIGJlIHByb2Nlc3NlZC4KCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgdG9yY2guVGVuc29yOiBUaGUgcHJvY2Vzc2VkIGF1ZGlvIG91dHB1dCBhcyBhIGJ5dGVzIG9iamVjdC4KCiAgICAgICAgUmFpc2VzOgogICAgICAgICAgICBWYWx1ZUVycm9yOiBJZiB0aGVyZSBpcyBhbiBlcnJvciBwcm9jZXNzaW5nIHRoZSBhdWRpbyBvdXRwdXQuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBidWZmZXIgPSBpby5CeXRlc0lPKCkKICAgICAgICAgICAgdG9yY2guc2F2ZShvdXRwdXQsIGJ1ZmZlcikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHByb2Nlc3NpbmcgYXVkaW8gb3V0cHV0OiB7ZX0iKQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiRXJyb3IgcHJvY2Vzc2luZyBhdWRpbyBvdXRwdXQ6IHtlfSIpIGZyb20gZQogICAgICAgIHJldHVybiBidWZmZXIuZ2V0dmFsdWUoKQogICAgCiAgICBkZWYgX3Byb2Nlc3Nfb3V0cHV0KHNlbGYsIG91dHB1dDogc3RyKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgUHJvY2VzcyB0aGUgZmluYWwgb3V0cHV0IHRvIGVuY29kZSBpdCBpbiBiYXNlNjQgYW5kIGRlY29kZSBpdCB0byB1dGYtOC4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgb3V0cHV0IChzdHIpOiBUaGUgZmluYWwgb3V0cHV0IHRvIGJlIHByb2Nlc3NlZC4KCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgc3RyOiBUaGUgcHJvY2Vzc2VkIG91dHB1dCBhZnRlciBlbmNvZGluZyBhbmQgZGVjb2RpbmcuCiAgICAgICAgUmFpc2VzOgogICAgICAgICAgICBWYWx1ZUVycm9yOiBJZiB0aGVyZSBpcyBhbiBlcnJvciBwcm9jZXNzaW5nIHRoZSBmaW5hbCBvdXRwdXQuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvdXRwdXQgPSBiYXNlNjQuYjY0ZW5jb2RlKG91dHB1dCkuZGVjb2RlKCJ1dGYtOCIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBwcm9jZXNzaW5nIGZpbmFsIG91dHB1dDoge2V9IikKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIkVycm9yIHByb2Nlc3NpbmcgZmluYWwgb3V0cHV0OiB7ZX0iKSBmcm9tIGUKICAgICAgICByZXR1cm4gb3V0cHV0CgogICAgCmRlZiB0ZXh0MnRleHQodHJhbnNsYXRpb246IFRyYW5zbGF0aW9uLCBtaW5lcl9yZXF1ZXN0OiBPcHRpb25hbFtNaW5lclJlcXVlc3RdID0gTm9uZSk6CiAgICAiIiIKICAgIEdlbmVyYXRlcyBhIHRyYW5zbGF0aW9uIG9mIHRoZSBpbnB1dCB0ZXh0IGZyb20gRW5nbGlzaCB0byBGcmVuY2ggdXNpbmcgdGhlIGdpdmVuIFRyYW5zbGF0aW9uIG9iamVjdC4KCiAgICBBcmdzOgogICAgICAgIHRyYW5zbGF0aW9uIChUcmFuc2xhdGlvbik6IFRoZSBUcmFuc2xhdGlvbiBvYmplY3QgdXNlZCB0byBnZW5lcmF0ZSB0aGUgdHJhbnNsYXRpb24uCiAgICAgICAgbWluZXJfcmVxdWVzdCAoT3B0aW9uYWxbTWluZXJSZXF1ZXN0XSwgb3B0aW9uYWwpOiBUaGUgb3B0aW9uYWwgTWluZXJSZXF1ZXN0IG9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgZGF0YSBmb3IgdGhlIHRyYW5zbGF0aW9uLiBEZWZhdWx0cyB0byBOb25lLgoKICAgIFJldHVybnM6CiAgICAgICAgc3RyOiBUaGUgdHJhbnNsYXRlZCB0ZXh0IGZyb20gRW5nbGlzaCB0byBGcmVuY2guCgogICAgRXhhbXBsZToKICAgICAgICA+Pj4gdHJhbnNsYXRpb24gPSBUcmFuc2xhdGlvbigpCiAgICAgICAgPj4+IG1pbmVyX3JlcXVlc3QgPSBNaW5lclJlcXVlc3QoZGF0YT17ImlucHV0IjogIkhlbGxvLCBteSBuYW1lIGlzIEpvaG4gRG9lLiIsICJ0YXNrX3N0cmluZyI6ICJ0ZXh0MnRleHQiLCAic291cmNlX2xhbmd1YWdlIjogIkVuZ2xpc2giLCAidGFyZ2V0X2xhbmd1YWdlIjogIkZyZW5jaCJ9KQogICAgICAgID4+PiB0ZXh0MnRleHQodHJhbnNsYXRpb24sIG1pbmVyX3JlcXVlc3QpCiAgICAgICAgJ0JvbmpvdXIsIGplIG0nYXBwZWxsZSBKb2huIERvZS4nCiAgICAiIiIKICAgIHRyYW5zbGF0aW9uX3JlcXVlc3QgPSBtaW5lcl9yZXF1ZXN0IG9yIE1pbmVyUmVxdWVzdCgKICAgICAgICBkYXRhPXsiaW5wdXQiOiAiSGVsbG8sIG15IG5hbWUgaXMgSm9obiBEb2UuIiwgInRhc2tfc3RyaW5nIjogInRleHQydGV4dCIsICJzb3VyY2VfbGFuZ3VhZ2UiOiAiRW5nbGlzaCIsICJ0YXJnZXRfbGFuZ3VhZ2UiOiAiRnJlbmNoIn0KICAgICkKICAgIHJldHVybiB0cmFuc2xhdGlvbi5wcm9jZXNzKHRyYW5zbGF0aW9uX3JlcXVlc3QpCgoKZGVmIHRleHQyc3BlZWNoKHRyYW5zbGF0aW9uOiBUcmFuc2xhdGlvbiwgbWluZXJfcmVxdWVzdDogT3B0aW9uYWxbTWluZXJSZXF1ZXN0XSA9IE5vbmUpOgogICAgIiIiCiAgICBHZW5lcmF0ZXMgc3BlZWNoIGZyb20gdGV4dCB1c2luZyB0aGUgZ2l2ZW4gVHJhbnNsYXRpb24gb2JqZWN0LgoKICAgIEFyZ3M6CiAgICAgICAgdHJhbnNsYXRpb24gKFRyYW5zbGF0aW9uKTogVGhlIFRyYW5zbGF0aW9uIG9iamVjdCB1c2VkIHRvIGdlbmVyYXRlIHRoZSBzcGVlY2guCiAgICAgICAgbWluZXJfcmVxdWVzdCAoT3B0aW9uYWxbTWluZXJSZXF1ZXN0XSwgb3B0aW9uYWwpOiBUaGUgb3B0aW9uYWwgTWluZXJSZXF1ZXN0IG9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgZGF0YSBmb3IgdGhlIHNwZWVjaCBnZW5lcmF0aW9uLiBEZWZhdWx0cyB0byBOb25lLgoKICAgIFJldHVybnM6CiAgICAgICAgVW5pb25bc3RyLCBOb25lXTogVGhlIGdlbmVyYXRlZCBzcGVlY2ggYXMgYSBzdHJpbmcsIG9yIE5vbmUgaWYgYW4gZXJyb3Igb2NjdXJyZWQuCiAgICAiIiIKICAgIHRyYW5zbGF0aW9uX3JlcXVlc3QgPSBtaW5lcl9yZXF1ZXN0IG9yIE1pbmVyUmVxdWVzdCgKICAgICAgICBkYXRhPXsiaW5wdXQiOiAiSGVsbG8sIG15IG5hbWUgaXMgSm9obiBEb2UuIiwgInRhc2tfc3RyaW5nIjogInRleHQyc3BlZWNoIiwgInNvdXJjZV9sYW5ndWFnZSI6ICJFbmdsaXNoIiwgInRhcmdldF9sYW5ndWFnZSI6ICJGcmVuY2gifQogICAgKQogICAgcmV0dXJuIHRyYW5zbGF0aW9uLnByb2Nlc3ModHJhbnNsYXRpb25fcmVxdWVzdCkKCgpkZWYgc3BlZWNoMnRleHQodHJhbnNsYXRpb246IFRyYW5zbGF0aW9uLCBtaW5lcl9yZXF1ZXN0OiBPcHRpb25hbFtNaW5lclJlcXVlc3RdID0gTm9uZSk6CiAgICAiIiIKICAgIEEgZnVuY3Rpb24gdGhhdCBjb252ZXJ0cyBzcGVlY2ggaW5wdXQgdG8gdGV4dCB1c2luZyBhIGdpdmVuIFRyYW5zbGF0aW9uIG9iamVjdC4KICAgIAogICAgQXJnczoKICAgICAgICB0cmFuc2xhdGlvbiAoVHJhbnNsYXRpb24pOiBUaGUgVHJhbnNsYXRpb24gb2JqZWN0IHVzZWQgZm9yIHRoZSBjb252ZXJzaW9uLgogICAgICAgIG1pbmVyX3JlcXVlc3QgKE9wdGlvbmFsW01pbmVyUmVxdWVzdF0sIG9wdGlvbmFsKTogQWRkaXRpb25hbCBkYXRhIGZvciB0aGUgY29udmVyc2lvbi4gRGVmYXVsdHMgdG8gTm9uZS4KICAgICAgICAKICAgIFJldHVybnM6CiAgICAgICAgVGhlIHByb2Nlc3NlZCB0ZXh0IG91dHB1dC4KICAgICIiIgogICAgdHJhbnNsYXRpb25fcmVxdWVzdCA9IG1pbmVyX3JlcXVlc3Qgb3IgTWluZXJSZXF1ZXN0KAogICAgICAgIGRhdGE9eyJpbnB1dCI6ICJtb2R1bGVzL3RyYW5zbGF0aW9uL2luL2F1ZGlvX3JlcXVlc3Qud2F2IiwgInRhc2tfc3RyaW5nIjogInNwZWVjaDJ0ZXh0IiwgInNvdXJjZV9sYW5ndWFnZSI6ICJFbmdsaXNoIiwgInRhcmdldF9sYW5ndWFnZSI6ICJGcmVuY2gifQogICAgKQogICAgcmV0dXJuIHRyYW5zbGF0aW9uLnByb2Nlc3ModHJhbnNsYXRpb25fcmVxdWVzdCkKCgpkZWYgc3BlZWNoMnNwZWVjaCh0cmFuc2xhdGlvbjogVHJhbnNsYXRpb24sIG1pbmVyX3JlcXVlc3Q6IE9wdGlvbmFsW01pbmVyUmVxdWVzdF0gPSBOb25lKToKICAgICIiIgogICAgQ29udmVydHMgc3BlZWNoIGlucHV0IHRvIHNwZWVjaCBvdXRwdXQgdXNpbmcgYSBnaXZlbiBUcmFuc2xhdGlvbiBvYmplY3QuCiAgICAKICAgIEFyZ3M6CiAgICAgICAgdHJhbnNsYXRpb24gKFRyYW5zbGF0aW9uKTogVGhlIFRyYW5zbGF0aW9uIG9iamVjdCB1c2VkIGZvciB0aGUgY29udmVyc2lvbi4KICAgICAgICBtaW5lcl9yZXF1ZXN0IChPcHRpb25hbFtNaW5lclJlcXVlc3RdLCBvcHRpb25hbCk6IEFkZGl0aW9uYWwgZGF0YSBmb3IgdGhlIGNvbnZlcnNpb24uIERlZmF1bHRzIHRvIE5vbmUuCiAgICAgICAgCiAgICBSZXR1cm5zOgogICAgICAgIFRoZSBwcm9jZXNzZWQgc3BlZWNoIG91dHB1dC4KICAgICIiIgogICAgdHJhbnNsYXRpb25fcmVxdWVzdCA9IG1pbmVyX3JlcXVlc3Qgb3IgTWluZXJSZXF1ZXN0KAogICAgICAgIGRhdGE9eyJpbnB1dCI6ICJtb2R1bGVzL3RyYW5zbGF0aW9uL2luL2F1ZGlvX3JlcXVlc3Qud2F2IiwgInRhc2tfc3RyaW5nIjogInNwZWVjaDJzcGVlY2giLCAic291cmNlX2xhbmd1YWdlIjogIkVuZ2xpc2giLCAidGFyZ2V0X2xhbmd1YWdlIjogIkZyZW5jaCJ9CiAgICApCiAgICByZXR1cm4gdHJhbnNsYXRpb24ucHJvY2Vzcyh0cmFuc2xhdGlvbl9yZXF1ZXN0KQogICAgCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgdHJhbnNsYXRpb24gPSBUcmFuc2xhdGlvbihUcmFuc2xhdGlvbkNvbmZpZygpKQogICAgcmVzdWx0ID0gc3BlZWNoMnRleHQodHJhbnNsYXRpb24pCiAgICBwcmludChmInNwZWVjaDJ0ZXh0OiB7cmVzdWx0fSIpCiAgICByZXN1bHQgPSBzcGVlY2gyc3BlZWNoKHRyYW5zbGF0aW9uKQogICAgcHJpbnQoZiJzcGVlY2gyc3BlZWNoOiB7cmVzdWx0fSIpCiAgICByZXN1bHQgPSB0ZXh0MnRleHQodHJhbnNsYXRpb24pCiAgICBwcmludChmInRleHQydGV4dDoge3Jlc3VsdH0iKQogICAgcmVzdWx0ID0gdGV4dDJzcGVlY2godHJhbnNsYXRpb24pCiAgICBwcmludChmInRleHQyc3BlZWNoOiB7cmVzdWx0fSIpCiAgICAgICAgCiAgICA='),
    ('__init__.py', ''),
    ('data_models.py', 'aW1wb3J0IG9zCmltcG9ydCB0b3JjaAppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGJhc2U2NAppbXBvcnQgc3VicHJvY2Vzcwpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKZnJvbSBsb2d1cnUgaW1wb3J0IGxvZ2dlcgpmcm9tIHB5ZGFudGljIGltcG9ydCBCYXNlTW9kZWwsIEZpZWxkCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBVbmlvbiwgT3B0aW9uYWwsIEFueSwgTGlzdApmcm9tIGFiYyBpbXBvcnQgQUJDLCBhYnN0cmFjdG1ldGhvZApmcm9tIGZhc3RhcGkgaW1wb3J0IEFQSVJvdXRlciwgRmFzdEFQSSwgUmVxdWVzdApmcm9tIGZhc3RhcGkuc3RhdGljZmlsZXMgaW1wb3J0IFN0YXRpY0ZpbGVzCmZyb20gZmFzdGFwaS5taWRkbGV3YXJlLmNvcnMgaW1wb3J0IENPUlNNaWRkbGV3YXJlCmZyb20gc3Vic3RyYXRlaW50ZXJmYWNlLmtleXBhaXIgaW1wb3J0IEtleXBhaXIKCgphcHAgPSBGYXN0QVBJKCkKCmFwcC5hZGRfbWlkZGxld2FyZSgKICAgIENPUlNNaWRkbGV3YXJlLAogICAgYWxsb3dfb3JpZ2lucz1bIioiXSwKICAgIGFsbG93X2NyZWRlbnRpYWxzPVRydWUsCiAgICBhbGxvd19tZXRob2RzPVsiKiJdLAogICAgYWxsb3dfaGVhZGVycz1bIioiXSwKKQphcHAubW91bnQoIi9pbiIsIFN0YXRpY0ZpbGVzKGRpcmVjdG9yeT0ibW9kdWxlcy90cmFuc2xhdGlvbi9pbiIpLCBuYW1lPSJpbiIpCmFwcC5tb3VudCgiL291dCIsIFN0YXRpY0ZpbGVzKGRpcmVjdG9yeT0ibW9kdWxlcy90cmFuc2xhdGlvbi9vdXQiKSwgbmFtZT0ib3V0IikKClRBU0tfU1RSSU5HUyA9IHsKICAgICJzcGVlY2gydGV4dCI6ICJzMnR0IiwKICAgICJzcGVlY2gyc3BlZWNoIjogInMyc3QiLAogICAgImF1dG9fc3BlZWNoX3JlY29nbml0aW9uIjogImFzciIsCiAgICAidGV4dDJzcGVlY2giOiAidDJzdCIsCiAgICAidGV4dDJ0ZXh0IjogInQydHQiLAp9CgpUQVJHRVRfTEFOR1VBR0VTID0gewogICAgIkVuZ2xpc2giOiAiZW5nIiwKICAgICJBZnJpa2FhbnMiOiAiYWZyIiwKICAgICJBbWhhcmljIjogImFtaCIsCiAgICAiTW9kZXJuIFN0YW5kYXJkIEFyYWJpYyI6ICJhcmIiLAogICAgIk1vcm9jY2FuIEFyYWJpYyI6ICJhcnkiLAogICAgIkVneXB0aWFuIEFyYWJpYyI6ICJhcnoiLAogICAgIkFzc2FtZXNlIjogImFzbSIsCiAgICAiQXN0dXJpYW4iOiAiYXN0IiwKICAgICJOb3J0aCBBemVyYmFpamFuaSI6ICJhemoiLAogICAgIkJlbGFydXNpYW4iOiAiYmVsIiwKICAgICJCZW5nYWxpIjogImJlbiIsCiAgICAiQm9zbmlhbiI6ICJib3MiLAogICAgIkJ1bGdhcmlhbiI6ICJidWwiLAogICAgIkNhdGFsYW4iOiAiY2F0IiwKICAgICJDZWJ1YW5vIjogImNlYiIsCiAgICAiQ3plY2giOiAiY2VzIiwKICAgICJDZW50cmFsIjogImNrYiIsCiAgICAiTWFuZGFyaW4gQ2hpbmVzZSI6ICJjbW4iLAogICAgIk1hbmRhcmluIENoaW5lc2UgSGFudCI6ICJjbW5fSGFudCIsCiAgICAiV2Vsc2giOiAiY3ltIiwKICAgICJEYW5pc2giOiAiZGFuIiwKICAgICJHZXJtYW4iOiAiZGV1IiwKICAgICJFc3RvbmlhbiI6ICJlc3QiLAogICAgIkJhc3F1ZSI6ICJldXMiLAogICAgIkZpbm5pc2giOiAiZmluIiwKICAgICJGcmVuY2giOiAiZnJhIiwKICAgICJOaWdlcmlhbiBGdWxmdWxkZSI6ICJmdXYiLAogICAgIldlc3QgQ2VudHJhbCBPcm9tbyI6ICJnYXoiLAogICAgIklyaXNoIjogImdsZSIsCiAgICAiR2FsaWNpYW4iOiAiZ2xnIiwKICAgICJHdWphcmF0aSI6ICJndWoiLAogICAgIkhlYnJldyI6ICJoZWIiLAogICAgIkhpbmRpIjogImhpbiIsCiAgICAiQ3JvYXRpYW4iOiAiaHJ2IiwKICAgICJIdW5nYXJpYW4iOiAiaHVuIiwKICAgICJBcm1lbmlhbiI6ICJoeWUiLAogICAgIklnYm8iOiAiaWJvIiwKICAgICJJbmRvbmVzaWFuIjogImluZCIsCiAgICAiSWNlbGFuZGljIjogImlzbCIsCiAgICAiSXRhbGlhbiI6ICJpdGEiLAogICAgIkphdmFuZXNlIjogImphdiIsCiAgICAiSmFwYW5lc2UiOiAianBuIiwKICAgICJLYW1iYSI6ICJrYW0iLAogICAgIkthbm5hZGEiOiAia2FuIiwKICAgICJHZW9yZ2lhbiI6ICJrYXQiLAogICAgIkthemFraCI6ICJrYXoiLAogICAgIkthYnV2ZXJkaWFudSI6ICJrZWEiLAogICAgIkhhbGggTW9uZ29saWFuIjogImtoayIsCiAgICAiS2htZXIiOiAia2htIiwKICAgICJLeXJneXoiOiAia2lyIiwKICAgICJLb3JlYW4iOiAia29yIiwKICAgICJMYW8iOiAibGFvIiwKICAgICJMaXRodWFuaWFuIjogImxpdCIsCiAgICAiTHV4ZW1ib3VyZ2lzaCI6ICJsdHoiLAogICAgIkdhbmRhIjogImx1ZyIsCiAgICAiTHVvIjogImx1byIsCiAgICAiU3RhbmRhcmQgTGF0dmlhbiI6ICJsdnMiLAogICAgIk1haXRoaWxpIjogIm1haSIsCiAgICAiTWFsYXlhbGFtIjogIm1hbCIsCiAgICAiTWFyYXRoaSI6ICJtYXIiLAogICAgIk1hY2Vkb25pYW4iOiAibWtkIiwKICAgICJNYWx0ZXNlIjogIm1sdCIsCiAgICAiTWVpdGVpIjogIm1uaSIsCiAgICAiQnVybWVzZSI6ICJteWEiLAogICAgIkR1dGNoIjogIm5sZCIsCiAgICAiTm9yd2VnaWFuIE55bm9yc2siOiAibm5vIiwKICAgICJOb3J3ZWdpYW4gQm9rbcOlbCI6ICJub2IiLAogICAgIk5lcGFsaSI6ICJucGkiLAogICAgIk55YW5qYSI6ICJueWEiLAogICAgIk9jY2l0YW4iOiAib2NpIiwKICAgICJPZGlhIjogIm9yeSIsCiAgICAiUHVuamFiaSI6ICJwYW4iLAogICAgIlNvdXRoZXJuIFBhc2h0byI6ICJwYnQiLAogICAgIldlc3Rlcm4gUGVyc2lhbiI6ICJwZXMiLAogICAgIlBvbGlzaCI6ICJwb2wiLAogICAgIlBvcnR1Z3Vlc2UiOiAicG9yIiwKICAgICJSb21hbmlhbiI6ICJyb24iLAogICAgIlJ1c3NpYW4iOiAicnVzIiwKICAgICJTbG92YWsiOiAic2xrIiwKICAgICJTbG92ZW5pYW4iOiAic2x2IiwKICAgICJTaG9uYSI6ICJzbmEiLAogICAgIlNpbmRoaSI6ICJzbmQiLAogICAgIlNvbWFsaSI6ICJzb20iLAogICAgIlNwYW5pc2giOiAic3BhIiwKICAgICJTZXJiaWFuIjogInNycCIsCiAgICAiU3dlZGlzaCI6ICJzd2UiLAogICAgIlN3YWhpbGkiOiAic3doIiwKICAgICJUYW1pbCI6ICJ0YW0iLAogICAgIlRlbHVndSI6ICJ0ZWwiLAogICAgIlRhamlrIjogInRnayIsCiAgICAiVGFnYWxvZyI6ICJ0Z2wiLAogICAgIlRoYWkiOiAidGhhIiwKICAgICJUdXJraXNoIjogInR1ciIsCiAgICAiVWtyYWluaWFuIjogInVrciIsCiAgICAiVXJkdSI6ICJ1cmQiLAogICAgIk5vcnRoZXJuIFV6YmVrIjogInV6biIsCiAgICAiVmlldG5hbWVzZSI6ICJ2aWUiLAogICAgIlhob3NhIjogInhobyIsCiAgICAiWW9ydWJhIjogInlvciIsCiAgICAiQ2FudG9uZXNlIjogInl1ZSIsCiAgICAiQ29sbG9xdWlhbCBNYWxheSI6ICJ6bG0iLAogICAgIlN0YW5kYXJkIE1hbGF5IjogInpzbSIsCiAgICAiWnVsdSI6ICJ6dWwiLAp9CgoKY2xhc3MgTW9kdWxlQ29uZmlnKEJhc2VNb2RlbCk6CiAgICBtb2R1bGVfbmFtZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgIG1vZHVsZV9wYXRoOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgbW9kdWxlX2VuZHBvaW50OiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgbW9kdWxlX3VybDogT3B0aW9uYWxbc3RyXSA9IE5vbmUKCgpjbGFzcyBCYXNlTW9kdWxlKEJhc2VNb2RlbCk6CiAgICBtb2R1bGVfY29uZmlnOiBPcHRpb25hbFtNb2R1bGVDb25maWddID0gTm9uZQogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgbW9kdWxlX2NvbmZpZzogTW9kdWxlQ29uZmlnKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKG1vZHVsZV9jb25maWc9bW9kdWxlX2NvbmZpZykKICAgICAgICBzZWxmLm1vZHVsZV9jb25maWcgPSBtb2R1bGVfY29uZmlnCiAgICAgICAgc2VsZi5pbml0X21vZHVsZSgpCiAgICAgICAgCiAgICBkZWYgaW5pdF9tb2R1bGUoc2VsZik6CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHNlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfcGF0aCk6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKHNlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfcGF0aCkKICAgICAgICAgICAgc2VsZi5pbnN0YWxsX21vZHVsZShzZWxmLm1vZHVsZV9jb25maWcpCiAgICAgICAgCiAgICBkZWYgX2NoZWNrX2FuZF9wcm9tcHQoc2VsZiwgcGF0aDogUGF0aCwgbWVzc2FnZTogc3RyKSAtPiBPcHRpb25hbFtzdHJdOgogICAgICAgIGlmIHBhdGguZXhpc3RzKCk6CiAgICAgICAgICAgIGNvbnRlbnQgPSBwYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKQogICAgICAgICAgICBwcmludChjb250ZW50KQogICAgICAgICAgICB1c2VyX2lucHV0ID0gaW5wdXQoZiJ7bWVzc2FnZX0gRG8geW91IHdhbnQgdG8gb3ZlcndyaXRlIGl0PyAoeS9uKSAiKS5sb3dlcigpCiAgICAgICAgICAgIHJldHVybiBOb25lIGlmIHVzZXJfaW5wdXQgaW4gWyd5JywgJ3llcyddIGVsc2UgY29udGVudAogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIGNoZWNrX3B1YmxpY19rZXkoc2VsZikgLT4gT3B0aW9uYWxbc3RyXToKICAgICAgICBwdWJsaWNfa2V5X3BhdGggPSBQYXRoKCJkYXRhL3B1YmxpY19rZXkucHViIikKICAgICAgICByZXR1cm4gc2VsZi5fY2hlY2tfYW5kX3Byb21wdChwdWJsaWNfa2V5X3BhdGgsICJQdWJsaWMga2V5IGV4aXN0cy4iKQoKICAgIGRlZiBnZXRfcHVibGljX2tleShzZWxmLCBrZXlfbmFtZTogc3RyID0gInB1YmxpY19rZXkiLCBwdWJsaWNfa2V5X3BhdGg6IHN0ciA9ICJkYXRhL3B1YmxpY19rZXkucGVtIik6CiAgICAgICAgcHVibGljX2tleSA9IHJlcXVlc3RzLmdldChmIntzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3VybH0vbW9kdWxlcy97a2V5X25hbWV9IiwgdGltZW91dD0zMCkudGV4dAogICAgICAgIG9zLm1ha2VkaXJzKCJkYXRhIiwgZXhpc3Rfb2s9VHJ1ZSkKICAgICAgICBleGlzdGluZ19rZXkgPSBzZWxmLmNoZWNrX3B1YmxpY19rZXkoKQogICAgICAgIGlmIGV4aXN0aW5nX2tleSBpcyBOb25lOgogICAgICAgICAgICBQYXRoKHB1YmxpY19rZXlfcGF0aCkud3JpdGVfdGV4dChwdWJsaWNfa2V5LCBlbmNvZGluZz0idXRmLTgiKQogICAgICAgIHJldHVybiBleGlzdGluZ19rZXkgb3IgcHVibGljX2tleQogICAgICAgIAogICAgZGVmIGNoZWNrX2Zvcl9leGlzdGluZ19tb2R1bGUoc2VsZikgLT4gT3B0aW9uYWxbc3RyXToKICAgICAgICBtb2R1bGVfc2V0dXBfcGF0aCA9IFBhdGgoZiJ7c2VsZi5tb2R1bGVfY29uZmlnLm1vZHVsZV9wYXRofS9zZXR1cF97c2VsZi5tb2R1bGVfY29uZmlnLm1vZHVsZV9uYW1lfS5weSIpCiAgICAgICAgcmV0dXJuIHNlbGYuX2NoZWNrX2FuZF9wcm9tcHQobW9kdWxlX3NldHVwX3BhdGgsICJNb2R1bGUgZXhpc3RzLiIpCiAgICAgICAgICAgICAgICAKICAgIGRlZiBnZXRfbW9kdWxlKHNlbGYpOgogICAgICAgIG1vZHVsZSA9IHJlcXVlc3RzLmdldChmIntzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3VybH17c2VsZi5tb2R1bGVfY29uZmlnLm1vZHVsZV9lbmRwb2ludH0iLCB0aW1lb3V0PTMwKS50ZXh0CiAgICAgICAgb3MubWFrZWRpcnMoIm1vZHVsZXMiLCBleGlzdF9vaz1UcnVlKQogICAgICAgIAogICAgICAgIG1vZHVsZV9zZXR1cF9wYXRoID0gUGF0aChmIntzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3BhdGh9L3NldHVwX3tzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX25hbWV9LnB5IikKICAgICAgICBleGlzdGluZ19tb2R1bGUgPSBzZWxmLmNoZWNrX2Zvcl9leGlzdGluZ19tb2R1bGUoKQogICAgICAgIAogICAgICAgIGlmIGV4aXN0aW5nX21vZHVsZSBpcyBOb25lOgogICAgICAgICAgICBvcy5tYWtlZGlycyhzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3BhdGgsIGV4aXN0X29rPVRydWUpCiAgICAgICAgICAgIG1vZHVsZV9zZXR1cF9wYXRoLndyaXRlX3RleHQobW9kdWxlLCBlbmNvZGluZz0idXRmLTgiKQogICAgICAgIHJldHVybiBleGlzdGluZ19tb2R1bGUgb3IgbW9kdWxlCgogICAgZGVmIHJlbW92ZV9tb2R1bGUoc2VsZik6CiAgICAgICAgUGF0aChzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3BhdGgpLnJtZGlyKCkKICAgICAgICAKICAgIGRlZiBzYXZlX21vZHVsZShzZWxmLCBtb2R1bGVfZGF0YTogc3RyKToKICAgICAgICBQYXRoKGYie3NlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfcGF0aH0vc2V0dXBfe3NlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfbmFtZX0ucHkiKS53cml0ZV90ZXh0KG1vZHVsZV9kYXRhLCBlbmNvZGluZz0idXRmLTgiKQoKICAgIGRlZiBzZXR1cF9tb2R1bGUoc2VsZik6CiAgICAgICAgc3VicHJvY2Vzcy5ydW4oZiJweXRob24ge3NlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfcGF0aH0vc2V0dXBfe3NlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfbmFtZX0ucHkiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQoKICAgIGRlZiB1cGRhdGVfbW9kdWxlKHNlbGYsIG1vZHVsZV9jb25maWc6IE1vZHVsZUNvbmZpZyk6CiAgICAgICAgc2VsZi5pbnN0YWxsX21vZHVsZShtb2R1bGVfY29uZmlnPW1vZHVsZV9jb25maWcpCgogICAgZGVmIGluc3RhbGxfbW9kdWxlKHNlbGYsIG1vZHVsZV9jb25maWc6IE1vZHVsZUNvbmZpZyk6CiAgICAgICAgc2VsZi5tb2R1bGVfY29uZmlnID0gbW9kdWxlX2NvbmZpZwogICAgICAgIHNlbGYuZ2V0X21vZHVsZSgpCiAgICAgICAgc2VsZi5zZXR1cF9tb2R1bGUoKSAgICAgICAgCiAgICAgICAgc3VicHJvY2Vzcy5ydW4oZiJiYXNoIHtzZWxmLm1vZHVsZV9jb25maWcubW9kdWxlX3BhdGh9L2luc3RhbGxfe3NlbGYubW9kdWxlX2NvbmZpZy5tb2R1bGVfbmFtZX0uc2giLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgICAgCgpjbGFzcyBUcmFuc2xhdGlvbkNvbmZpZyhCYXNlTW9kZWwpOgogICAgbW9kZWxfbmFtZV9vcl9jYXJkOiBVbmlvbltzdHIsIEFueV0gPSAiZmFjZWJvb2svc2VhbWxlc3MtTTRULVYyLWxhcmdlIgogICAgdm9jb2Rlcl9uYW1lOiBzdHIgPSAoCiAgICAgICAgInZvY29kZXJfdjIiCiAgICAgICAgaWYgbW9kZWxfbmFtZV9vcl9jYXJkID09ICJmYWNlYm9vay9zZWFtbGVzcy1NNFQtVjItbGFyZ2UiCiAgICAgICAgZWxzZSAidm9jb2Rlcl8zNmxhbmdzIgogICAgKQogICAgZGV2aWNlOiBBbnkgPSB0b3JjaC5kZXZpY2UoZGV2aWNlPSJjdWRhOjAiKQogICAgdGV4dF90b2tlbml6ZXI6IHN0ciA9IG1vZGVsX25hbWVfb3JfY2FyZAogICAgYXBwbHlfbWludG94OiBib29sID0gKFRydWUsKQogICAgZHR5cGU6IEFueSA9ICh0b3JjaC5mbG9hdDE2LCkKICAgIGlucHV0X21vZGFsaXR5OiBPcHRpb25hbFtBbnldID0gKE5vbmUsKQogICAgb3V0cHV0X21vZGFsaXR5OiBPcHRpb25hbFtBbnldID0gTm9uZQoKCmNsYXNzIE1pbmVyUmVxdWVzdChCYXNlTW9kZWwpOgogICAgZGF0YTogT3B0aW9uYWxbQW55XSA9IE5vbmUKICAgIAogICAgCmNsYXNzIFRyYW5zbGF0aW9uRGF0YShCYXNlTW9kZWwpOgogICAgaW5wdXQ6IHN0cgogICAgdGFza19zdHJpbmc6IHN0cgogICAgc291cmNlX2xhbmd1YWdlOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgdGFyZ2V0X2xhbmd1YWdlOiBzdHIKICAgIAogICAgCmNsYXNzIFRyYW5zbGF0aW9uUmVxdWVzdChNaW5lclJlcXVlc3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRhdGE6IFRyYW5zbGF0aW9uRGF0YSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5kYXRhID0gZGF0YQoKCmNsYXNzIE1pbmVyQ29uZmlnKEJhc2VNb2RlbCk6CiAgICBtaW5lcl9uYW1lOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgbWluZXJfa2V5cGF0aDogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgIG1pbmVyX2hvc3Q6IE9wdGlvbmFsW3N0cl0gPSBOb25lCiAgICBleHRlcm5hbF9hZGRyZXNzOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgbWluZXJfcG9ydDogT3B0aW9uYWxbaW50XSA9IE5vbmUKICAgIHN0YWtlOiBPcHRpb25hbFtmbG9hdF0gPSBOb25lCiAgICBuZXR1aWQ6IE9wdGlvbmFsW2ludF0gPSBOb25lCiAgICBmdW5kaW5nX2tleTogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgIGZ1bmRpbmdfbW9kaWZpZXI6IE9wdGlvbmFsW2Zsb2F0XSA9IE5vbmUKICAgIG1vZHVsZV9uYW1lOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgICAgIAoKY2xhc3MgQmFzZU1pbmVyKEFCQyk6CiAgICBtb2R1bGVfY29uZmlnOiBPcHRpb25hbFtNb2R1bGVDb25maWddID0gTm9uZQogICAgbW9kdWxlX2NvbmZpZ3M6IE9wdGlvbmFsW0xpc3RbTWluZXJDb25maWddXSA9IFtdCiAgICBtaW5lcl9rZXlfZGljdDogT3B0aW9uYWxbRGljdFtzdHIsIEFueV1dID0ge30KICAgIGtleV9uYW1lOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgbWluZXJzOiBPcHRpb25hbFtEaWN0W3N0ciwgQW55XV0gPSB7fQogICAgcm91dGVyOiBPcHRpb25hbFtBUElSb3V0ZXJdID0gTm9uZQogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgbW9kdWxlX2NvbmZpZzogTW9kdWxlQ29uZmlnLCBtaW5lcl9jb25maWc6IE1pbmVyQ29uZmlnKToKICAgICAgICBzZWxmLm1vZHVsZV9jb25maWcgPSBtb2R1bGVfY29uZmlnCiAgICAgICAgc2VsZi5taW5lcl9jb25maWcgPSBtaW5lcl9jb25maWcKICAgICAgICBzZWxmLm1vZHVsZV9jb25maWdzID0gc2VsZi5fbG9hZF9jb25maWdzKCJtb2R1bGVzL21vZHVsZV9jb25maWdzLmpzb24iKQogICAgICAgIHNlbGYubWluZXJfY29uZmlncyA9IHNlbGYuX2xvYWRfY29uZmlncygibW9kdWxlcy9taW5lcl9jb25maWdzLmpzb24iKQogICAgICAgIHNlbGYubWluZXJzID0gc2VsZi5fbG9hZF9taW5lcl9rZXlzKCkKICAgICAgICBzZWxmLnJvdXRlciA9IEFQSVJvdXRlcigpCgogICAgZGVmIF9sb2FkX2NvbmZpZ3Moc2VsZiwgZmlsZV9wYXRoOiBzdHIpIC0+IExpc3RbRGljdFtzdHIsIEFueV1dOgogICAgICAgIHBhdGggPSBQYXRoKGZpbGVfcGF0aCkKICAgICAgICBpZiBwYXRoLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhwYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgICAgICBjb25maWdzID0gW10KICAgICAgICBwYXRoLndyaXRlX3RleHQoanNvbi5kdW1wcyhjb25maWdzLCBpbmRlbnQ9NCksIGVuY29kaW5nPSJ1dGYtOCIpCiAgICAgICAgcmV0dXJuIGNvbmZpZ3MKCiAgICBkZWYgX2xvYWRfbWluZXJfa2V5cyhzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICBrZXlfcGF0aCA9IFBhdGgoImRhdGEvaW5zdGFuY2VfZGF0YS9taW5lcl9rZXlzLmpzb24iKQogICAgICAgIGlmIGtleV9wYXRoLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhrZXlfcGF0aC5yZWFkX3RleHQoZW5jb2Rpbmc9InV0Zi04IikpCiAgICAgICAgCiAgICAgICAgc2VsZi5taW5lcl9rZXlfZGljdCA9IHsKICAgICAgICAgICAgY29uZmlnWyJtaW5lcl9uYW1lIl06IGpzb24ubG9hZHMoUGF0aChjb25maWdbIm1pbmVyX2tleXBhdGgiXSkucmVhZF90ZXh0KGVuY29kaW5nPSJ1dGYtOCIpKQogICAgICAgICAgICBmb3IgY29uZmlnIGluIHNlbGYubWluZXJfY29uZmlncwogICAgICAgICAgICBpZiBQYXRoKGNvbmZpZ1sibWluZXJfa2V5cGF0aCJdKS5leGlzdHMoKQogICAgICAgIH0KICAgICAgICAKICAgICAgICBrZXlfcGF0aC53cml0ZV90ZXh0KGpzb24uZHVtcHMoc2VsZi5taW5lcl9rZXlfZGljdCwgaW5kZW50PTQpLCBlbmNvZGluZz0idXRmLTgiKQogICAgICAgIHJldHVybiBzZWxmLm1pbmVyX2tleV9kaWN0CgogICAgZGVmIGFkZF9yb3V0ZShzZWxmLCBtb2R1bGVfbmFtZTogc3RyKToKICAgICAgICBAc2VsZi5yb3V0ZXIucG9zdChmIi9tb2R1bGVzL3ttb2R1bGVfbmFtZX0vcHJvY2VzcyIpCiAgICAgICAgZGVmIHByb2Nlc3NfcmVxdWVzdChyZXF1ZXN0OiBNaW5lclJlcXVlc3QpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcocmVxdWVzdC5kYXRhWyJpbnB1dCJdWzA6MzBdKQogICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHJlcXVlc3QuZGF0YVsidGFza19zdHJpbmciXSkKICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhyZXF1ZXN0LmRhdGFbInNvdXJjZV9sYW5ndWFnZSJdKQogICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHJlcXVlc3QuZGF0YVsidGFyZ2V0X2xhbmd1YWdlIl0pCiAgICAgICAgICAgICAgICByZXMgPSBzZWxmLnByb2Nlc3MocmVxdWVzdCkKICAgICAgICAgICAgICAgIHJldHVybiByZXMKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGUpCiAgICAgICAgICAgICAgICByZXR1cm4geyJlcnJvciI6IHN0cihlKX0KICAgICAgICBhcHAuaW5jbHVkZV9yb3V0ZXIoc2VsZi5yb3V0ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHJ1bl9zZXJ2ZXIoaG9zdF9hZGRyZXNzOiBzdHIsIHBvcnQ6IGludCk6CiAgICAgICAgaW1wb3J0IHV2aWNvcm4KICAgICAgICB1dmljb3JuLnJ1bihhcHAsIGhvc3Q9aG9zdF9hZGRyZXNzLCBwb3J0PXBvcnQpCgogICAgZGVmIGFkZF9taW5lcl9rZXkoc2VsZiwga2V5X25hbWU6IHN0ciwgbWluZXJfa2V5cGF0aDogUGF0aCA9IFBhdGgoImRhdGEvaW5zdGFuY2VfZGF0YS9taW5lcl9rZXlzLmpzb24iKSwgbWluZXJfY29uZmlnOiBPcHRpb25hbFtNaW5lckNvbmZpZ10gPSBOb25lKToKICAgICAgICBpZiBtaW5lcl9jb25maWc6CiAgICAgICAgICAgIHNlbGYubWluZXJfa2V5X2RpY3Rba2V5X25hbWVdID0gbWluZXJfY29uZmlnLm1vZGVsX2R1bXAoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbmZpZyA9IHNlbGYuX3Byb21wdF9taW5lcl9jb25maWcoKQogICAgICAgICAgICBzZWxmLm1pbmVyX2tleV9kaWN0W2tleV9uYW1lXSA9IGNvbmZpZy5tb2RlbF9kdW1wKCkKICAgICAgICAKICAgICAgICBzZWxmLl9zYXZlX21pbmVyX2tleXMobWluZXJfa2V5cGF0aCkKCiAgICBkZWYgX3Byb21wdF9taW5lcl9jb25maWcoc2VsZikgLT4gTWluZXJDb25maWc6CiAgICAgICAgcmV0dXJuIE1pbmVyQ29uZmlnKAogICAgICAgICAgICBtaW5lcl9uYW1lPWlucHV0KCJFbnRlciBtaW5lcl9uYW1lOiAiKSwKICAgICAgICAgICAgbWluZXJfa2V5cGF0aD1pbnB1dCgiRW50ZXIgbWluZXJfa2V5cGF0aCBbZXguICRIT01FLy5jb21tdW5lL2tleS9teV9taW5lci5qc29uXTogIikgb3IgTm9uZSwKICAgICAgICAgICAgbWluZXJfaG9zdD1pbnB1dCgiRW50ZXIgbWluZXJfaG9zdCBbZGVmYXVsdCAwLjAuMC4wXTogIikgb3IgIjAuMC4wLjAiLAogICAgICAgICAgICBleHRlcm5hbF9hZGRyZXNzPWlucHV0KCJFbnRlciBleHRlcm5hbF9hZGRyZXNzOiAiKSBvciBOb25lLAogICAgICAgICAgICBtaW5lcl9wb3J0PWludChpbnB1dCgiRW50ZXIgbWluZXJfcG9ydCBbZGVmYXVsdCA1NzU3XTogIikgb3IgNTc1NyksCiAgICAgICAgICAgIHN0YWtlPWZsb2F0KGlucHV0KCJFbnRlciBzdGFrZSBbZGVmYXVsdCAyNzVDT01dOiAiKSBvciAyNzUpLAogICAgICAgICAgICBuZXR1aWQ9aW50KGlucHV0KCJFbnRlciBuZXR1aWQgW2RlZmF1bHQgMF06ICIpIG9yIDApLAogICAgICAgICAgICBmdW5kaW5nX2tleT1pbnB1dCgiRW50ZXIgZnVuZGluZ19rZXk6ICIpLAogICAgICAgICAgICBmdW5kaW5nX21vZGlmaWVyPWZsb2F0KGlucHV0KCJFbnRlciBtb2RpZmllciBbZGVmYXVsdCAxNUNPTV06ICIpIG9yIDE1KSwKICAgICAgICApCgogICAgZGVmIHJlbW92ZV9taW5lcl9rZXkoc2VsZiwga2V5X25hbWU6IHN0ciwgbWluZXJfa2V5cGF0aDogUGF0aCk6CiAgICAgICAgc2VsZi5taW5lcl9rZXlfZGljdC5wb3Aoa2V5X25hbWUsIE5vbmUpCiAgICAgICAgc2VsZi5fc2F2ZV9taW5lcl9rZXlzKG1pbmVyX2tleXBhdGgpCgogICAgZGVmIHVwZGF0ZV9taW5lcl9rZXkoc2VsZiwga2V5X25hbWU6IHN0ciwgbWluZXJfY29uZmlnOiBNaW5lckNvbmZpZywgbWluZXJfa2V5cGF0aDogUGF0aCk6CiAgICAgICAgc2VsZi5taW5lcl9rZXlfZGljdFtrZXlfbmFtZV0gPSBtaW5lcl9jb25maWcubW9kZWxfZHVtcCgpCiAgICAgICAgc2VsZi5fc2F2ZV9taW5lcl9rZXlzKG1pbmVyX2tleXBhdGgpCgogICAgZGVmIF9zYXZlX21pbmVyX2tleXMoc2VsZiwgbWluZXJfa2V5cGF0aDogUGF0aCk6CiAgICAgICAgbWluZXJfa2V5cGF0aC53cml0ZV90ZXh0KGpzb24uZHVtcHMoc2VsZi5taW5lcl9rZXlfZGljdCwgaW5kZW50PTQpLCBlbmNvZGluZz0idXRmLTgiKQoKICAgIGRlZiBnZXRfa2V5cGFpcihzZWxmLCBrZXlfbmFtZTogc3RyKSAtPiBLZXlwYWlyOgogICAgICAgIGtleV9mb2xkZXJfcGF0aCA9IFBhdGgoc2VsZi5tb2R1bGVfY29uZmlnLmtleV9mb2xkZXJfcGF0aCkKICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKChrZXlfZm9sZGVyX3BhdGggLyBmIntrZXlfbmFtZX0uanNvbiIpLnJlYWRfdGV4dChlbmNvZGluZz0ndXRmLTgnKSlbImRhdGEiXQogICAgICAgIGtleV9kYXRhID0ganNvbi5sb2Fkcyhqc29uX2RhdGEpCiAgICAgICAgcmV0dXJuIEtleXBhaXIoa2V5X2RhdGFbInByaXZhdGVfa2V5Il0sIGtleV9kYXRhWyJwdWJsaWNfa2V5Il0sIGtleV9kYXRhWyJzczU4X2FkZHJlc3MiXSkKCiAgICBkZWYgcmVnaXN0ZXJfbWluZXIoc2VsZiwgbWluZXJfY29uZmlnOiBNaW5lckNvbmZpZyk6CiAgICAgICAgY29tbWFuZCA9IGYiYmFzaCBtb2R1bGVzL3NldHVwX21pbmVycy5zaCB7bWluZXJfY29uZmlnLm1pbmVyX25hbWV9IHttaW5lcl9jb25maWcubWluZXJfa2V5cGF0aH0ge21pbmVyX2NvbmZpZy5leHRlcm5hbF9hZGRyZXNzfSB7bWluZXJfY29uZmlnLm1pbmVyX3BvcnR9IHttaW5lcl9jb25maWcuc3Rha2V9IHttaW5lcl9jb25maWcubmV0dWlkfSB7bWluZXJfY29uZmlnLmZ1bmRpbmdfa2V5fSB7bWluZXJfY29uZmlnLmZ1bmRpbmdfbW9kaWZpZXJ9IgogICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIHNoZWxsPVRydWUsIGNoZWNrPVRydWUsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKICAgICAgICBsb2dnZXIuaW5mbyhyZXN1bHQuc3Rkb3V0KQogICAgICAgIGxvZ2dlci5pbmZvKHJlc3VsdC5zdGRlcnIpCiAgICAgICAgCiAgICBkZWYgc2VydmVfbWluZXIoc2VsZiwgbWluZXJfY29uZmlnOiBNaW5lckNvbmZpZywgcmVnaXN0ZXI6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc2VsZi5hZGRfcm91dGUobWluZXJfY29uZmlnLm1vZHVsZV9uYW1lKQogICAgICAgIGlmIHJlZ2lzdGVyOgogICAgICAgICAgICBzZWxmLnJlZ2lzdGVyX21pbmVyKG1pbmVyX2NvbmZpZykKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJSZWdpc3RlcmVkIHttaW5lcl9jb25maWcubWluZXJfbmFtZX0gYXQge21pbmVyX2NvbmZpZy5leHRlcm5hbF9hZGRyZXNzfTp7bWluZXJfY29uZmlnLm1pbmVyX3BvcnR9IikKICAgICAgICBzZWxmLnJ1bl9zZXJ2ZXIobWluZXJfY29uZmlnLm1pbmVyX2hvc3QsIG1pbmVyX2NvbmZpZy5taW5lcl9wb3J0KQoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIHByb2Nlc3Moc2VsZiwgcmVxdWVzdDogUmVxdWVzdCkgLT4gQW55OgogICAgICAgICIiIlByb2Nlc3MgYSByZXF1ZXN0IG1hZGUgdG8gdGhlIG1vZHVsZS4iIiIgICAgIAo='),
    ('install_translation.sh', 'IyEvYmluL2Jhc2gKCnNldCAtZQoKc291cmNlIC4vLnZlbnYvYmluL2FjdGl2YXRlCgpweXRob24gLW0gcGlwIGluc3RhbGwgLS11cGdyYWRlIHBpcAoKcGlwIGluc3RhbGwgc2V0dXB0b29scyB3aGVlbCBnbnVyZWFkbGluZQpwaXAgaW5zdGFsbCBzbmRmaWxlIGdnbWwtcHl0aG9uIHN1YnN0cmF0ZS1pbnRlcmZhY2UgYml0dGVuc29yIGxvZ3VydQpwaXAgaW5zdGFsbCBmYXN0YXBpIHV2aWNvcm4gbG9ndXJ1IHJlcXVlc3RzIHN1YnN0cmF0ZS1pbnRlcmZhY2UKCnN1ZG8gYXB0LWdldCB1cGRhdGUgJiYgc3VkbyBhcHQtZ2V0IHVwZ3JhZGUgLXkKc3VkbyBhcHQtZ2V0IGluc3RhbGwgcHl0aG9uMyBweXRob24zLWRldiBweXRob24zLXZlbnYgcHl0aG9uMy1waXAgcHl0aG9uLWlzLXB5dGhvbjMgbGlic25kZmlsZTEtZGV2IGxpYmdtcDEwLWRldiAteQoKaWYgWyAhIC1kICIuL21vZHVsZXMvdHJhbnNsYXRpb24vc2VhbWxlc3MiIF07IHRoZW4KICAgIGdpdCBjbG9uZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2tyZXNlYXJjaC9zZWFtbGVzc19jb21tdW5pY2F0aW9uLmdpdCAuL21vZHVsZXMvdHJhbnNsYXRpb24vc2VhbWxlc3MKICAgIApmaQpwaXAgaW5zdGFsbCAuL21vZHVsZXMvdHJhbnNsYXRpb24vc2VhbWxlc3MKcGlwIGluc3RhbGwgZ2l0K2h0dHBzOi8vZ2l0aHViLmNvbS9odWdnaW5nZmFjZS90cmFuc2Zvcm1lcnMgdG9yY2ggdG9yY2hhdWRpbyB0b3JjaHZpc2lvbiBmYWlyc2VxMgoKbWtkaXIgLXAgLi9tb2R1bGVzL3RyYW5zbGF0aW9uL2luCgpta2RpciAtcCAuL21vZHVsZXMvdHJhbnNsYXRpb24vb3V0Cg=='),
]

for relative_path, encoded_content in file_data:
    full_path = os.path.join(folder_path, relative_path)
    os.makedirs(os.path.dirname(full_path), exist_ok=True)
    with open(full_path, 'wb') as f:
        f.write(base64.b64decode(encoded_content))
    print(f'Created: {full_path}')
command = ['bash', 'modules/translation/install_translation.sh']
subprocess.run(command, check=True)
